trigger:
  branches:
    include:
      - main

pool:
  name: Default   # your selfâ€‘hosted agent pool (or use 'HostedÂ WindowsÂ 2022' if you want Microsoftâ€‘hosted)

variables:
  imageName: 'customer-churn-prediction'
  dockerHubRepo: 'adityaram24/$(imageName)'
  dockerfilePath: 'Dockerfile'

steps:
- checkout: self
  displayName: 'ğŸ”„ Checkout code'

- script: docker version
  displayName: 'ğŸ‹ Verify Docker connectivity'

- task: Docker@2
  displayName: 'ğŸ”¨ Build image'
  inputs:
    command: build
    dockerfile: $(dockerfilePath)
    buildContext: '$(Build.SourcesDirectory)'
    repository: $(dockerHubRepo)
    tags: |
      latest

- task: Docker@2
  displayName: 'ğŸš€ Push to DockerÂ Hub'
  inputs:
    command: push
    containerRegistry: 'docker-hub-connection'   # make sure this service connection is set up
    repository: $(dockerHubRepo)
    tags: |
      latest
