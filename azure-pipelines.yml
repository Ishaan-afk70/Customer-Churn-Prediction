trigger:
  branches:
    include:
      - main

pool:
  name: Default   # your self‑hosted agent pool (or use 'Hosted Windows 2022' if you want Microsoft‑hosted)

variables:
  imageName: 'customer-churn-prediction'
  dockerHubRepo: 'adityaram24/$(imageName)'
  dockerfilePath: 'Dockerfile'

steps:
- checkout: self
  displayName: '🔄 Checkout code'

- script: docker version
  displayName: '🐋 Verify Docker connectivity'

- task: Docker@2
  displayName: '🔨 Build image'
  inputs:
    command: build
    dockerfile: $(dockerfilePath)
    buildContext: '$(Build.SourcesDirectory)'
    repository: $(dockerHubRepo)
    tags: |
      latest

- task: Docker@2
  displayName: '🚀 Push to Docker Hub'
  inputs:
    command: push
    containerRegistry: 'docker-hub-connection'   # make sure this service connection is set up
    repository: $(dockerHubRepo)
    tags: |
      latest
